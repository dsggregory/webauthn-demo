<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Webauthn Demo Auth</title>
    <link rel="stylesheet" type="text/css" href="/styles/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="index.js"></script>
    <script>
        $(document).ready(function () {
            $('#username').keypress(function (e) {
                if (e.keyCode == 13)
                    $('#login-button').click();
            });

            checkUserRegistrationCeremony()
        });
    </script>
</head>

<body>

<nav class="navbar navbar-light">
    <div class="container-fluid">
        <img src="/images/logo.png">
    </div>
</nav>

<div class="hero">
    <div class="container w-50">
        <div class="row">
            <div class="main-content col-md-12">
                <div class="row">
                    <div class="hero-left order-2 col-lg-9 order-lg-1">
                        <h2>Webauthn Demo</h2>
                        <h5>Login with your WebAuthn Passkey to continue.</h5>


                        <div class="mt-5 hero-form" x-data="global">
                            <section class="form-group">
                                <div class="form-row">
                                    <div class="col-sm-12 mb-3">
                                        <input type="text" class="form-control form-control-lg" id="username"
                                               placeholder="Email" x-model="username" autocomplete="username webauthn">
                                    </div>
                                    <div class="col-sm-12">
                                        <div class="alert.alertClass alert-danger" id="error"></div>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="row">
                                        <div class="col-sm-8 mb-3">
                                            <button class="btn btn-block btn-primary" id="login-button"
                                                    onclick="loginUser()">
                                                Login
                                            </button>
                                        </div>
                                        <div class="col-sm-4 mb-3">
                                            <button class="btn btn-block btn-primary" type="submit" id="register-button"
                                                    onclick="registerUser()" title="Register a new passkey">
                                                Register
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!--

<label><b>Username:</b></label>
<div class="col-sm-12 mb-3">
<input type="text" name="username" id="username" autocomplete="username webauthn" placeholder="Email">
</div>
<div class="col-sm-6 mb-3">
<button class="btn btn-block btn-primary" id="register-button" onclick="registerUser()" title="Use this to register a passkey for your user">Register</button>
</div>
<div class="col-sm-6 mb-3">
    <button class="btn btn-block btn-primary" id="login-button" onclick="loginUser()">authenticate</button>
</div>
<div class="col-sm-6 mb-3">
<button id="btnLogout" name="btnLogout"><a href="/logout">Logout</a></button>
</div>
-->

<script>

    $(document).ready(function () {
        // check whether current browser supports WebAuthn
        if (!window.PublicKeyCredential) {
            alert("Error: this browser does not support WebAuthn");
            return;
        }

        autofillUI();
    });

</script>
</div>
</body>

</html>